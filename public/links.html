<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç½‘ç«™çŸ­é“¾æœåŠ¡</title>
    <link href="/static/style.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
</head>
<body>
<div class="container">
    <div class="form-container">
        <h1>ç”Ÿæˆé“¾æ¥ä¿¡æ¯</h1>
        <div class="form-group">
            <label for="suffix_full" style="display: inline-block;">ç”Ÿæˆé“¾æ¥ï¼š</label>
            <a id="suffix_link" href="" target="_blank">
                <div id="suffix_full" style="display: inline-block;"></div>
            </a>
        </div>
        <div class="form-group">
            <label for="record_urls" style="display: inline-block;">ç›®æ ‡åœ°å€ï¼š</label>
            <a id="record_link" href="" target="_blank">
                <div id="record_urls" style="display: inline-block;"></div>
            </a>
        </div>
        <div class="form-group">
            <label for="tokens_text" style="display: inline-block;">æ›´æ–°å¯†ç ï¼š</label>
            <div id="tokens_text" style="display: inline-block;"></div>
        </div>
        <div class="form-group">
            <label for="typing_text" style="display: inline-block;">è·³è½¬ç±»å‹ï¼š</label>
            <div id="typing_text" style="display: inline-block;"></div>
        </div>
        <div class="form-group">
            <label for="expire_days" style="display: inline-block;">è¿‡æœŸæ—¶é—´ï¼š</label>
            <div id="expire_days" style="display: inline-block;"></div>
        </div>
        <div class="form-group">
            <label for="guests_pass" style="display: inline-block;">è®¿é—®å¯†ç ï¼š</label>
            <div id="guests_pass" style="display: inline-block;"></div>
        </div>
        <div class="form-group hint" style="padding-bottom: 5%">è®¤è¯å¯†ç æ—¶ï¼Œå¦‚æœ‰ç”¨æˆ·åè¯·ç•™ç©ºï¼Œå¯†ç è¾“å…¥ä¸Šæ–¹æ˜¾ç¤ºçš„å¯†ç </div>
        <div class="form-group">
            <label for="spider_text" style="text-align: center;">WebHookè¯·æ±‚å†…å®¹</label>
            <textarea id="spider_text" rows="7" cols="40" onclick="onText()"
                      style="display: block; opacity: 0.5; border-radius: 10px;width: 90%;padding-left: 5%;padding-right: 5%;"></textarea>
        </div>
        <div class="form-group">
            <label for="spider_path" style="text-align: center;">WebHookè¯·æ±‚åœ°å€</label>
            <textarea id="spider_path" rows="1" cols="40" onclick="onPath()"
                      style="display: block; opacity: 0.5; border-radius: 3px;width: 90%;padding-left: 5%;padding-right: 5%;"></textarea>
        </div>
        <div class="form-group hint" style="text-align: center;">Lucky->STUNç©¿é€->ç¼–è¾‘->WebHook->è¯·æ±‚ä½“
            <a href="https://github.com/PIKACHUIM/CFWorkerUrls/blob/main/NATDOG.md">[ğŸ”—ä½¿ç”¨æ–¹æ³•]</a><br/>
        </div>
        <div class="form-group hint" style="text-align: center;" id="hostname_ip"></div>
        <div class="form-group hint" style="text-align: center;">ä¸Šè¿°ä¿¡æ¯ä»…æ˜¾ç¤ºä¸€æ¬¡ï¼Œç¦»å¼€æˆ–å…³é—­æœ¬é¡µé¢åå°†æ— æ³•å†æ¬¡æŸ¥çœ‹</div>
        <br/><br/>
        <button class="modify-btn" onclick="onPost()">ä¿®æ”¹é“¾æ¥</button>
        <br/><br/>
        <button class="update-btn" onclick="location.href='/';">è¿”å›ä¸»é¡µ</button>
        <button class="github-btn" onclick="location.href='https://github.com/PIKACHUIM/CFWorkerUrls';">
            <img src="/static/white.png" width="12px" height="12px">&nbsp;GitHubé¡µé¢
        </button>
    </div>
</div>
<script>
    // é¡µé¢è½½å…¥å‡½æ•° #######################################################
    function onLoad(name) {
        const queryString = window.location.search;
        // ä½¿ç”¨URLSearchParamsè§£ææŸ¥è¯¢å­—ç¬¦ä¸² ==============================
        const urlParams = new URLSearchParams(queryString);
        // åˆ¤æ–­æ˜¯å¦åŒ…å«tokenså‚æ•° =========================================
        if (urlParams.has('suffix')) {
            const suffix = urlParams.get('suffix');
            const tokens = urlParams.get('tokens');
            const suffix_full = document.getElementById('suffix_full');
            const suffix_link = document.getElementById('suffix_link');
            const spider_text = document.getElementById('spider_text');
            const hostname_ip = document.getElementById('hostname_ip');
            const spider_path = document.getElementById('spider_path');
            spider_path
            suffix_full.textContent = suffix;
            suffix_link.href = suffix;
            spider_text.textContent = '' +
                '{' +
                '\n  "suffix": "' + suffix.split("/").pop() + '",' +
                '\n  "tokens": "' + tokens + '",' +
                '\n  "typing": "http",' +
                '\n  "ipaddr": "{ip}",' +
                '\n  "porter": "{port}"' +
                '\n}';

            let hostname = window.location.hostname;
            hostname_ip.textContent = "Webhookè¯·æ±‚ç±»å‹ï¼šPOSTï¼Œæ£€æµ‹æˆåŠŸå­—ç¬¦ä¸²ï¼šSuccessfully"
            spider_path.textContent = "https://" + hostname + "/p/"
        }
        if (urlParams.has('tokens')) {
            const tokens = urlParams.get('tokens');
            const tokens_text = document.getElementById('tokens_text');
            tokens_text.textContent = tokens;
        }
        if (urlParams.has('guests')) {
            const guests = urlParams.get('guests');
            const guests_pass = document.getElementById('guests_pass');
            guests_pass.textContent = guests;
        }
        if (urlParams.has('typing')) {
            const typing = urlParams.get('typing');
            const typing_text = document.getElementById('typing_text');
            const typing_maps = {
                "iframe": "é¡µé¢åµŒå¥—",
                "direct": "é“¾æ¥è·³è½¬",
                "proxys": "äº‘ç«¯ä»£ç†",
                "hidden": "éšè—ä»£ç†",
                "agents": "å‰ç½®ä»£ç†",
            };
            typing_text.textContent = typing_maps[typing];
        }
        if (urlParams.has('record')) {
            const record = urlParams.get('record');
            const record_urls = document.getElementById('record_urls');
            const record_link = document.getElementById('record_link');
            record_link.href = record;
            record_urls.textContent = record;
        }
        if (urlParams.has('expire')) {
            const expire = urlParams.get('expire');
            const expire_days = document.getElementById('expire_days');
            const date_t = new Date(Number(expire));
            expire_days.textContent = date_t.toISOString().substring(0, 19);
        }
    }

    // æäº¤è¡¨å•å‡½æ•° #######################################################
    function onPost(name) {
        // ä½¿ç”¨URLSearchParamsè§£ææŸ¥è¯¢å­—ç¬¦ä¸² ==============================
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const suffix_full = urlParams.get('suffix');
        const tokens_text = urlParams.get('tokens');
        const guests_pass = urlParams.get('guests');
        window.open("/a/?update=1" +
            "&suffix=" + suffix_full +
            "&tokens=" + tokens_text +
            "&guests=" + guests_pass
        );
    }

    // è‡ªåŠ¨å¤åˆ¶å†…å®¹ #######################################################
    function onText() {
        var copyText = document.getElementById("spider_text");
        copyText.select();
        document.execCommand("copy");
        // alert("å†…å®¹å·²å¤åˆ¶");
        Swal.fire({
            position: 'top',
            icon: 'success',
            title: 'å†…å®¹å·²å¤åˆ¶',
            showConfirmButton: false,
            timer: 700
        })
    }

    // è‡ªåŠ¨å¤åˆ¶å†…å®¹ #######################################################
    function onPath() {
        var copyText = document.getElementById("spider_path");
        copyText.select();
        document.execCommand("copy");
        // alert("å†…å®¹å·²å¤åˆ¶");
        Swal.fire({
            position: 'top',
            icon: 'success',
            title: 'é“¾æ¥å·²å¤åˆ¶',
            showConfirmButton: false,
            timer: 700
        })
    }

    // é¡µé¢åŠ è½½é€»è¾‘ #######################################################
    onLoad();
</script>

</body>
</html>